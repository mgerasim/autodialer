[recordnum-app]

exten => s,1,System(/home/asterisk/bin/record_num.sh ${num})
exten => s,n,Set(CDR(userfield)=${num})
exten => s,n,NoOp(CDR(userfield) = ${CDR(userfield)})
exten => s,n,Return()

[outgoing-welcome]
exten => s,1,Answer(500)
exten=> s,n,AMD()
exten=> s,n,NoOp(${AMDSTATUS})
   same => n(loop),Background(${vote_welcome})
   same => n,WaitExten(5)
exten => 1,1,Goto(outgoing-end,s,1)

[outgoing-finish]
exten => s,1,System(/home/asterisk/bin/record_num.sh ${num})
exten => s,n,Set(CDR(userfield)=${num})
        same => n(loop), Background(${vote_push_two})
        same => n, WaitExten(5)
        same => n,Hangup()
exten => 2,1,Goto(outgoing-push-two,s,1)

[outgoing-push-two]
exten => s,1,PlayBack(${vote_finish})
exten => s,n,Hangup()

[outgoing-end]
exten => s,1,System(/home/rails/projects/autodialer/asterisk/record_num.sh ${num})
exten => s,n,Set(CDR(userfield)=${num})
exten => s,n,NoOp(CDR(userfield) = ${CDR(userfield)})
exten => s,n,PlayBack(${vote_finish})
exten => s,n,Hangup()

;[call-out]
;exten => s,1,Answer ; отвечаем
;exten => s,n,Dial(Local/${num}@from-internal) ;звоним соединяем клиента с оператором
